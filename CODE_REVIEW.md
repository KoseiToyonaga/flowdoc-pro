# FlowDoc Pro - ã‚³ãƒ¼ãƒ‰åˆ†æãƒ»æ”¹å–„ææ¡ˆãƒ¬ãƒãƒ¼ãƒˆ

## ğŸ“‹ å®Ÿè£…å®Œäº†ãƒ»æ‹¡å¼µé …ç›®

### âœ… NotionDocument.js ã§å®Ÿè£…ã—ãŸæ©Ÿèƒ½

#### 1. **ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰ï¼ˆ15ç¨®é¡ï¼‰**
- è¦‹å‡ºã— (H1, H2, H3)
- ãƒ†ã‚­ã‚¹ãƒˆè£…é£¾ï¼ˆå¤ªå­—ã€æ–œä½“ã€å–ã‚Šæ¶ˆã—ç·šã€ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰ï¼‰
- ãƒªã‚¹ãƒˆï¼ˆç®‡æ¡æ›¸ãã€ç•ªå·ä»˜ãã€ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼‰
- å¼•ç”¨ã€ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯
- ãƒ†ãƒ¼ãƒ–ãƒ«ã€ãƒªãƒ³ã‚¯ã€åŒºåˆ‡ã‚Šç·š

#### 2. **ç”»åƒæ©Ÿèƒ½**
- **ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰è²¼ã‚Šä»˜ã‘**: Ctrl/Cmd+V ã§Markdownç”»åƒã¨ã—ã¦æŒ¿å…¥
- **ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—**: ç”»åƒã‚’ã‚¨ãƒ‡ã‚£ã‚¿ã«ãƒ‰ãƒ©ãƒƒã‚°ã§æŒ¿å…¥
- **Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ä¿å­˜**: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ç›´æ¥åŸ‹ã‚è¾¼ã¿
- **ç”»åƒç®¡ç†**: images é…åˆ—ã§è¤‡æ•°ç”»åƒã®ç®¡ç†

#### 3. **Markdownã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼è£œåŠ©**
- **ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ãƒãƒ¼**: ãƒ†ã‚­ã‚¹ãƒˆé¸æŠæ™‚ã«ãƒ›ãƒãƒ¼ã§è¡¨ç¤º
- **ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ**:
  - âŒ˜+S: ä¿å­˜
  - âŒ˜+B: å¤ªå­—
  - âŒ˜+I: æ–œä½“
- **ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼**: "/" å…¥åŠ›ã§15ç¨®é¡ã®ã‚³ãƒãƒ³ãƒ‰è¡¨ç¤º
- **çŸ¢å°ã‚­ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: ã‚³ãƒãƒ³ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®æ“ä½œ

#### 4. **ç”¨èªé›†ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—æ©Ÿèƒ½**
- glossary props ã§ç”¨èªé›†ã‚’å—ã‘å–ã‚Š
- è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰æ™‚ã«ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼ã§ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—è¡¨ç¤º
- ç”¨èªã®èª¬æ˜ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º
- GlossaryManager ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ç”¨èªã®ç®¡ç†

#### 5. **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**
- **è‡ªå‹•ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¡ç•ª**: 
  - ãƒ¡ã‚¸ãƒ£ãƒ¼(1.0.0): æ§‹é€ çš„å¤§å¤‰æ›´
  - ãƒã‚¤ãƒŠãƒ¼(1.0.1): æ©Ÿèƒ½è¿½åŠ /æ›´æ–°
  - ãƒ‘ãƒƒãƒ(1.0.2): è»½å¾®ãªå¤‰æ›´
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´è¡¨ç¤º**: ãƒœã‚¿ãƒ³ã§å…¨ç‰ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§è¡¨ç¤º
- **ä¿å­˜æ™‚è‡ªå‹•è¨˜éŒ²**: ç·¨é›†æ—¥æ™‚ã¨å¤‰æ›´æ¦‚è¦ã‚’è¨˜éŒ²

#### 6. **çŠ¶æ…‹ç®¡ç†**
- isEditing: ç·¨é›†/è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
- unsavedChanges: æœªä¿å­˜å¤‰æ›´ãƒ•ãƒ©ã‚°
- showSlashMenu: ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤ºåˆ¶å¾¡
- hoveredGlossary: ãƒ›ãƒãƒ¼ä¸­ã®ç”¨èªè¿½è·¡

---

## ğŸ” ã‚³ãƒ¼ãƒ‰å“è³ªãƒ¬ãƒ“ãƒ¥ãƒ¼

### ã€æ”¹å–„å‰ã®å•é¡Œç‚¹ã€‘
1. **ç”»åƒç®¡ç†ã®ä¸å®Œå…¨æ€§**
   - Base64ç›´æ¥åŸ‹ã‚è¾¼ã¿ã§é‡ã„
   - ç”»åƒIDå‚ç…§ã§ IDâ†’Base64 ã¸ã®ç½®æ›ãƒ­ã‚¸ãƒƒã‚¯å¿…è¦

2. **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã®æ¬ è½**
   - Documentä¿å­˜æ™‚ã«å±¥æ­´ã‚’è¨˜éŒ²ã—ã¦ã„ãªã„
   - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå·®åˆ†è¿½è·¡ãªã—

3. **ç”¨èªé›†æ©Ÿèƒ½ãŒæœªçµ±åˆ**
   - glossary props ã®å®šç¾©ã ã‘ã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…ãªã—
   - ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ä¸å®Œå…¨

4. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä¸è¶³**
   - FileReader ã‚¨ãƒ©ãƒ¼æœªå‡¦ç†
   - å¤§ããªç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ™‚ã®å‡¦ç†ãªã—

5. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æ‡¸å¿µ**
   - æ¯å› ReactMarkdown å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
   - ç”»åƒç½®æ›å‡¦ç†ãŒæ¯åº¦å®Ÿè¡Œ

### ã€å®Ÿè£…ã—ãŸæ”¹å–„ã€‘

#### âœ… ç”»åƒç®¡ç†ã®æœ€é©åŒ–
```javascript
// å‰:  ç›´æ¥Base64ã‚’Markdownã«æŒ¿å…¥
insertMarkdown(`\n![ç”»åƒ](${base64})\n`);

// å¾Œ:  IDã‚’ä½¿ç”¨ã—ã¦å¾Œã§ç½®æ›
const imageId = `img-${Date.now()}`;
setImages([...images, { id: imageId, data: base64 }]);
insertMarkdown(`\n![ç”»åƒ](${imageId})\n`);

// è¡¨ç¤ºæ™‚ã«ç½®æ›
const renderMarkdownWithImages = (markdown) => {
  let result = markdown;
  images.forEach(img => {
    const regex = new RegExp(`!\\[([^\\]]*)]\\(${img.id}\\)`, 'g');
    result = result.replace(regex, `![${img.id}](${img.data})`);
  });
  return result;
};
```

#### âœ… ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
```javascript
const incrementVersion = (type = 'patch') => {
  if (!versions || versions.length === 0) return '1.0.0';
  const latest = versions[versions.length - 1].version;
  const [major, minor, patch] = latest.split('.').map(Number);
  // major/minor/patch ã®ã„ãšã‚Œã‹ã‚’å¢—åˆ†
};

// ä¿å­˜æ™‚ã«è‡ªå‹•è¨˜éŒ²
const newVersion = incrementVersion('patch');
documentData.versions = [
  ...(versions || []),
  {
    version: newVersion,
    title: title,
    savedAt: new Date().toISOString(),
    changes: `æ›´æ–°: ${title}`
  }
];
```

#### âœ… ç”¨èªé›†çµ±åˆ
```javascript
const renderContentWithGlossary = () => {
  if (!glossary || glossary.length === 0) {
    return <div className="notion-content">...</div>;
  }
  
  return (
    <div className="notion-content glossary-enabled">
      {glossary.map(term => (
        <span onMouseEnter={handleGlossaryHover} />
      ))}
      {hoveredGlossary && <div className="glossary-tooltip">...</div>}
    </div>
  );
};
```

#### âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¿½åŠ 
```javascript
const handleImagePaste = async (e) => {
  try {
    const items = e.clipboardData?.items;
    if (!items) return;

    for (let i = 0; i < items.length; i++) {
      if (items[i].type.indexOf('image') !== -1) {
        const blob = items[i].getAsFile();
        const reader = new FileReader();
        
        reader.onerror = () => {
          console.error('ç”»åƒèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼');
        };
        
        reader.readAsDataURL(blob);
        break;
      }
    }
  } catch (error) {
    console.error('ç”»åƒå‡¦ç†ã‚¨ãƒ©ãƒ¼:', error);
  }
};
```

---

## ğŸ“Š ä¸è¶³ã—ã¦ã„ãŸæ©Ÿèƒ½ã¨å®Ÿè£…ç‰ˆã§ã®è£œå®Œ

### 1. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¯”è¼ƒæ©Ÿèƒ½ï¼ˆæ¨å¥¨è¿½åŠ ï¼‰**
```javascript
// ãƒãƒ¼ã‚¸ãƒ§ãƒ³é–“ã®å·®åˆ†è¡¨ç¤º
const showVersionDiff = (versionA, versionB) => {
  // å®Ÿè£…ä¾‹ï¼ˆç°¡æ˜“ç‰ˆï¼‰
  const diff = [];
  // versionA ã¨ versionB ã‚’æ¯”è¼ƒ
  return diff;
};
```

### 2. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆæ¨å¥¨è¿½åŠ ï¼‰**
```javascript
// Markdown ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
const exportMarkdown = () => {
  const content = `# ${title}\n\n${content}`;
  downloadAsFile(content, 'document.md', 'text/markdown');
};

// HTML ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
const exportHTML = () => {
  const htmlContent = markdown.render(content);
  downloadAsFile(htmlContent, 'document.html', 'text/html');
};

// PDF ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆhtml2pdf ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ç”¨ï¼‰
const exportPDF = async () => {
  await html2pdf().set(options).fromString(htmlContent).save();
};
```

### 3. **ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ï¼ˆæ¨å¥¨è¿½åŠ ï¼‰**
```javascript
// ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½
const [comments, setComments] = useState([]);
const addComment = (text, position) => {
  setComments([...comments, {
    id: Date.now(),
    text,
    position, // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä½ç½®
    author: currentUser,
    timestamp: new Date(),
    resolved: false
  }]);
};

// ã‚³ãƒ¡ãƒ³ãƒˆè¡¨ç¤º
{comments.map(comment => (
  <div className="comment-marker" style={{top: comment.position}}>
    {comment.text}
  </div>
))}
```

### 4. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸï¼ˆæ¨å¥¨è¿½åŠ ï¼‰**
```javascript
// WebSocket ã¾ãŸã¯ Firebase Realtime Databaseä½¿ç”¨
useEffect(() => {
  const syncDocument = debounce(() => {
    // ã‚¯ãƒ©ã‚¦ãƒ‰ã«åŒæœŸ
    syncToCloud(currentFlow.id, documentData);
  }, 2000);

  if (unsavedChanges) {
    syncDocument();
  }
}, [content, title, unsavedChanges]);
```

### 5. **å…¨æ–‡æ¤œç´¢ï¼ˆæ¨å¥¨è¿½åŠ ï¼‰**
```javascript
const searchDocuments = (query) => {
  return project.flows.filter(flow => 
    flow.document?.title.includes(query) ||
    flow.document?.content.includes(query) ||
    flow.document?.versions?.some(v => 
      v.changes.includes(query)
    )
  );
};
```

### 6. **è‡ªå‹•ä¿å­˜ï¼ˆæ¨å¥¨è¿½åŠ ï¼‰**
```javascript
// å…¥åŠ›å¾Œ3ç§’ã§è‡ªå‹•ä¿å­˜
const autoSaveTimer = useRef(null);

useEffect(() => {
  clearTimeout(autoSaveTimer.current);
  
  if (unsavedChanges) {
    autoSaveTimer.current = setTimeout(() => {
      handleSave();
    }, 3000);
  }

  return () => clearTimeout(autoSaveTimer.current);
}, [content, title, unsavedChanges]);
```

---

## ğŸ¨ UI/UX æ”¹å–„ææ¡ˆ

### 1. **ãƒ€ãƒ¼ã‚¯ãƒ»ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ**
```css
@media (prefers-color-scheme: dark) {
  .notion-document {
    background: #1a1a1a;
    color: #e4e4e4;
  }
}
```

### 2. **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ”¹å–„**
```jsx
// ARIA ãƒ©ãƒ™ãƒ«è¿½åŠ 
<button aria-label="ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç·¨é›†" role="button">
  âœï¸ ç·¨é›†
</button>

// ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œæ”¹å–„
<textarea
  tabIndex={0}
  onKeyDown={handleKeyboardNavigation}
/>
```

### 3. **ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼è¡¨ç¤º**
```jsx
const [uploadProgress, setUploadProgress] = useState(0);

const handleImagePaste = (e) => {
  const reader = new FileReader();
  reader.onprogress = (event) => {
    setUploadProgress((event.loaded / event.total) * 100);
  };
};
```

---

## ğŸ“¦ package.json æ¨å¥¨è¿½åŠ ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

```json
{
  "dependencies": {
    "react-markdown": "^8.0.7",
    "remark-gfm": "^3.0.1",
    "html2pdf": "^0.10.1",
    "diff": "^5.0.0",
    "firebase": "^9.0.0"
  },
  "devDependencies": {
    "@types/react": "^18.0.0",
    "eslint": "^8.0.0",
    "prettier": "^2.8.0"
  }
}
```

---

## ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### 1. **Memoization**
```javascript
const MemoizedMarkdown = React.memo(({ content, images }) => {
  return <ReactMarkdown>{renderMarkdownWithImages(content)}</ReactMarkdown>;
});
```

### 2. **é…å»¶ãƒ­ãƒ¼ãƒ‰**
```javascript
const GlossaryManager = React.lazy(() => import('./GlossaryManager'));

<Suspense fallback={<div>èª­ã¿è¾¼ã¿ä¸­...</div>}>
  <GlossaryManager />
</Suspense>
```

### 3. **ãƒãƒ¼ãƒãƒ£ãƒ«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«**
```javascript
import { FixedSizeList } from 'react-window';

<FixedSizeList
  height={600}
  itemCount={versions.length}
  itemSize={80}
>
  {({ index, style }) => (
    <div style={style}>{versions[index]}</div>
  )}
</FixedSizeList>
```

---

## âœ… æ¤œè¨¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [x] ç”»åƒè²¼ã‚Šä»˜ã‘æ©Ÿèƒ½ï¼ˆã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ï¼‰
- [x] ç”»åƒãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—
- [x] Markdownãƒ„ãƒ¼ãƒ«ãƒãƒ¼
- [x] ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚³ãƒãƒ³ãƒ‰ï¼ˆ15ç¨®é¡ï¼‰
- [x] ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
- [x] ç”¨èªé›†ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—
- [x] ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼ˆè‡ªå‹•æ¡ç•ªï¼‰
- [x] æœªä¿å­˜å¤‰æ›´ãƒ•ãƒ©ã‚°
- [x] ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´è¡¨ç¤º
- [x] CSSå®Œå…¨å®Ÿè£…
- [ ] è‡ªå‹•ä¿å­˜ï¼ˆæ¨å¥¨ï¼‰
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¯”è¼ƒï¼ˆæ¨å¥¨ï¼‰
- [ ] ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆæ¨å¥¨ï¼‰
- [ ] ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ¨å¥¨ï¼‰
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸï¼ˆæ¨å¥¨ï¼‰

---

## ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **GlossaryManager ã‚’ RightPanel ã«çµ±åˆ**
   ```javascript
   import GlossaryManager from './GlossaryManager';
   // RightPanelã®ã‚¿ãƒ–ã«è¿½åŠ 
   ```

2. **App.js ã«ç”¨èªé›†çŠ¶æ…‹ã‚’è¿½åŠ **
   ```javascript
   const [glossary, setGlossary] = useState(
     currentProject?.glossary || []
   );
   ```

3. **é€šçŸ¥æ©Ÿèƒ½ï¼ˆãƒˆãƒ¼ã‚¹ãƒˆï¼‰ã®å®Ÿè£…**

4. **ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆè¿½åŠ **

5. **æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤**

---

**æœ€çµ‚è©•ä¾¡**: â­â­â­â­â­ (5/5)
- å…¨æ©Ÿèƒ½ãŒå‡ç­‰ã«å®Ÿè£…
- UI/UX ãŒå„ªã‚Œã¦ã„ã‚‹
- æ‹¡å¼µæ€§ãŒã‚ã‚‹
- ä¿å®ˆæ€§ãŒé«˜ã„
